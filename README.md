1. –í—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ API –Ø–Ω–¥–µ–∫—Å.–ü–æ–≥–æ–¥—ã –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏—Ö –≤ csv
–ò—Å–ø–æ–ª—å–∑—É—è API –Ø–Ω–¥–µ–∫—Å.–ü–æ–≥–æ–¥—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ 7 –¥–Ω–µ–π –¥–ª—è –ú–æ—Å–∫–≤—ã, –ö–∞–∑–∞–Ω–∏, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞, –¢—É–ª—ã –∏ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ API –æ—Ç–¥–∞–µ—Ç –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—å, —Ç–æ –∏—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–∞–ª–∏—Ç—å.
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ —á–∞—Å–∞–º —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –ø–æ–ª–µ–π –ø–æ –æ—Å–∞–¥–∫–∞–º.
–ü–æ–ª—É—á–µ–Ω–Ω—ã–π json –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ csv, —Ñ–æ—Ä–º–∞—Ç:
city,date,hour,temperature_c,pressure_mm,is_rainy


ùëÄùëúùë†ùëêùëúùë§,19.08.2023,12,27,750,0


ùëÄùëúùë†ùëêùëúùë§,19.08.2023,13,27,750,0


...
ùêæùëéùëßùëéùëõ,19.08.2023,12,20,770,1


ùêæùëéùëßùëéùëõ,19.08.2023,13,21,770,0


–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π:
city - –ì–æ—Ä–æ–¥
date - –î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è
hour - –ß–∞—Å—ã
temperature_c - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –¶–µ–ª—å—Å–∏—è—Ö
pressure_mm - –î–∞–≤–ª–µ–Ω–∏–µ –≤ –º–º —Ä—Ç—É—Ç–Ω–æ–≥–æ —Å—Ç–æ–ª–±–∞
is_rainy - –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –¥–æ–∂–¥—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–Ω—å –∏ —á–∞—Å (—Å–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API - –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π).
–ü–æ–ª—É—á–µ–Ω–Ω—ã–π csv –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≥—Ä—É–∑–∏—Ç—å –Ω–∞ –æ–±–ª–∞—á–Ω—ã–π –¥–∏—Å–∫ –∏ –≤ –∫–æ–Ω—Ü–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É.
–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞: https://yandex.ru/dev/weather/doc/dg/concepts/about.html#about__onboarding
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã: –∫–∞–∫–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ API –∏ –∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è? –í–æ–∑–º–æ–∂–Ω–æ –ª–∏ —ç—Ç–∏ —Å–ø–æ—Å–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ Airflow?


3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î (Airflow + PostgreSQL).
–ò—Å–ø–æ–ª—å–∑—É—è –ø–æ–ª—É—á–µ–Ω–Ω—ã–π csv —Ñ–∞–π–ª, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∫–∞–∂–¥—ã–π —á–∞—Å –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ PostgreSQL. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤ –ë–î –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—ã: –¥–ª—è –ø—Ä–∏–µ–º–∫–∏ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–ª—è –±—É–¥—É—â–∏—Ö –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü.

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).

–í —Ä–µ—à–µ–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º –∏ —Ç–∞–±–ª–∏—Ü –¥–ª—è –ø—É–Ω–∫—Ç–∞ 2 –∏ 2.1.

–ü–æ–¥—Å–∫–∞–∑–∫–∞: –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ë–î –∏ Airflow, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —Å –ø–æ–º–æ—â—å—é –¥–æ–∫–µ—Ä–∞.


2.1 –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω (PostgreSQL).
–ò—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—É —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–±—Ä–∞—Ç—å –≤–∏—Ç—Ä–∏–Ω—É, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –∏ –¥–Ω—è –±—É–¥—É—Ç —É–∫–∞–∑–∞–Ω—ã —á–∞—Å—ã –Ω–∞—á–∞–ª–∞ –¥–æ–∂–¥—è. –£—Å–ª–æ–≤–∏–º—Å—è, —á—Ç–æ –¥–æ–∂–¥—å –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –∑–∞ –¥–µ–Ω—å –≤ –ª—é–±–æ–º –∏–∑ –≥–æ—Ä–æ–¥–æ–≤. –í–∏—Ç—Ä–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –µ–∂–µ—á–∞—Å–Ω–æ.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ç—Ä–∏–Ω—É, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞, –¥–Ω—è –∏ —á–∞—Å–∞ –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –∏ –ø–æ –¥–∞–≤–ª–µ–Ω–∏—é.


2.2 –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∫–∞–ø–∞
–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–µ–∫–∞–ø –≤—Å–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤ –≤–∏–¥–µ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –≤—Å–µ–≥–æ –≤—ã—à–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞.


# Weather Data Project

This project includes Apache Airflow DAGs for loading weather data, calculating metrics, and creating daily backups of a PostgreSQL database.

### Shared link for /weather_data.csv: https://yadi.sk/d/ZdaGdtyXRL3qZQ

## Project Structure
 ```bash
weather_data_project/
‚îú‚îÄ‚îÄ dags/
‚îÇ ‚îú‚îÄ‚îÄ load_weather_data_dag.py
‚îÇ ‚îú‚îÄ‚îÄ calculate_metrics_dag.py
‚îÇ ‚îî‚îÄ‚îÄ backup_dag.py
‚îú‚îÄ‚îÄ scripts
‚îÇ ‚îú‚îÄ fetch_and_transform_weather_data.ipynb
‚îÇ ‚îî‚îÄ‚îÄ create_tables.py
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ requirements.txt
 ```
## Installation

1. Clone the repository:

   ```bash
   git clone https://github.com/your-username/weather_data_project.git
   cd weather_data_project

1.    Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
2.   Set up your PostgreSQL database and update the connection string in DAGs accordingly.

# Usage

## Run Jupyter Notebook:
```bash
jupyter notebook fetch_and_transform_weather_data.ipynb
```
Open the notebook and execute each cell to fetch and transform weather data.
## Load Weather Data
1. Run the following DAG in Apache Airflow:

 ```bash
airflow trigger_dag load_weather_data
 ```

## Calculate Metrics
1. Run the following DAG in Apache Airflow:

 ```bash
airflow trigger_dag calculate_metrics
 ```

## Create Daily Backup
1. Run the following DAG in Apache Airflow:

 ```bash
airflow trigger_dag create_backup
 ```
## Notes
Make sure to set up appropriate PostgreSQL connection strings in DAGs.
Adjust schedule intervals and other configurations in DAGs according to your requirements. 
